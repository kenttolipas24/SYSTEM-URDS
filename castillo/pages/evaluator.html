<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluator Panel - URDS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/evaluator.css">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-content">
            <div>
                <h1>Research Evaluators Panel</h1>
                <p>Evaluation, Funding & Incentives</p>
            </div>
            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                Logout
            </button>
        </div>
    </nav>

    <div class="container">
        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card blue">
                <div class="stat-info">
                    <p>New Proposals</p>
                    <h2 id="newCount">5</h2>
                </div>
                <i class="fas fa-file-signature stat-icon blue"></i>
            </div>
            <div class="stat-card yellow">
                <div class="stat-info">
                    <p>Ongoing</p>
                    <h2 id="ongoingCount">8</h2>
                </div>
                <i class="fas fa-spinner stat-icon yellow"></i>
            </div>
            <div class="stat-card green">
                <div class="stat-info">
                    <p>Completed</p>
                    <h2 id="completedCount">20</h2>
                </div>
                <i class="fas fa-clipboard-check stat-icon green"></i>
            </div>
            <div class="stat-card purple">
                <div class="stat-info">
                    <p>Incentives Awarded</p>
                    <h2 id="awardedCount">3</h2>
                </div>
                <i class="fas fa-award stat-icon purple"></i>
            </div>
        </div>

        <div class="tabs-container">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('evaluator','new')"><i class="fas fa-file-medical"></i> New Proposals</button>
                <button class="tab" onclick="switchTab('evaluator','ongoing')"><i class="fas fa-briefcase"></i> Ongoing Research</button>
                <button class="tab" onclick="switchTab('evaluator','completed')"><i class="fas fa-trophy"></i> Completed Research</button>
                <button class="tab" onclick="switchTab('evaluator','panel')"><i class="fas fa-users"></i> Panel</button>
                <button class="tab" onclick="switchTab('evaluator','guidelines')"><i class="fas fa-book"></i> Guidelines</button>
            </div>

            <div class="tab-content">
                <div id="evaluator-new" class="tab-panel active">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchNew" placeholder="Search new proposals..." onkeyup="filterList('researchListNew', this.value)">
                    </div>
                    <div class="proposals-list" id="researchListNew"></div>
                </div>

                <div id="evaluator-ongoing" class="tab-panel">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchOngoing" placeholder="Search ongoing research..." onkeyup="filterList('researchListOngoing', this.value)">
                    </div>
                    <div class="proposals-list" id="researchListOngoing"></div>
                </div>

                <div id="evaluator-completed" class="tab-panel">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchCompleted" placeholder="Search completed research..." onkeyup="filterList('researchListCompleted', this.value)">
                    </div>
                    <div class="proposals-list" id="researchListCompleted"></div>
                </div>

                <div id="evaluator-panel" class="tab-panel">
                    <div class="info-box blue">
                        <h3>Evaluation Panel Members</h3>
                        <p>List of assigned evaluators for each panel. Panels evaluate proposals together and submit a collective decision.</p>
                    </div>
                    <div class="proposals-list" id="panelMembersList"></div>
                </div>

                <div id="evaluator-guidelines" class="tab-panel">
                    <div class="info-box blue">
                        <h3>Evaluation Rules & Incentives</h3>
                        <ul>
                            <li>New proposals: Evaluate for funding (UEP funding decision: Fund / Conditional / Decline).</li>
                            <li>Ongoing research: Evaluate for continuation or termination based on progress and deliverables.</li>
                            <li>Completed research: Provide a numerical rating (1-100). For Natural Sciences category, top 3 rated projects receive monetary incentives: 1st, 2nd, 3rd prizes.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Evaluation Modal (adapts by research status) -->
    <div id="evaluatorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Evaluate Research</h2>
            </div>
            <div class="modal-body">
                <p><strong id="modalResearchTitle"></strong></p>
                <p id="modalResearchAuthor" class="proposal-author"></p>
                <p id="modalResearchAbstract" style="margin-top:0.5rem;color:#374151;"></p>

                <div id="sectionFunding" class="form-group" style="display:none;">
                    <label>Funding Decision</label>
                    <select id="fundingDecision">
                        <option value="fund">Fund</option>
                        <option value="conditional">Conditional Fund</option>
                        <option value="decline">Decline</option>
                    </select>
                    <div class="form-group" style="margin-top:0.5rem;">
                        <label>Funding Notes (optional)</label>
                        <textarea id="fundingNotes" rows="3" placeholder="Add notes..."></textarea>
                    </div>
                </div>

                <div id="sectionContinuation" class="form-group" style="display:none;">
                    <label>Continuation Decision</label>
                    <select id="continuationDecision">
                        <option value="continue">Continue</option>
                        <option value="terminate">Terminate</option>
                    </select>
                    <div class="form-group" style="margin-top:0.5rem;">
                        <label>Comments (optional)</label>
                        <textarea id="continuationNotes" rows="3" placeholder="Add comments..."></textarea>
                    </div>
                </div>

                <div id="sectionRating" class="form-group" style="display:none;">
                    <label>Numerical Rating (1-100)</label>
                    <input type="number" id="numericRating" min="1" max="100" placeholder="Enter rating">
                    <div id="prizeSection" style="margin-top:0.75rem; display:none;">
                        <label>Prize (Natural Sciences only)</label>
                        <select id="prizeSelect">
                            <option value="none">No prize</option>
                            <option value="1st">1st Prize - ₱50,000</option>
                            <option value="2nd">2nd Prize - ₱30,000</option>
                            <option value="3rd">3rd Prize - ₱20,000</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-top:0.5rem;">
                        <label>Evaluator Comments</label>
                        <textarea id="ratingNotes" rows="4" placeholder="Enter evaluation notes..."></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeEvaluatorModal()">Cancel</button>
                <button class="btn btn-success" onclick="submitEvaluatorDecision()">Submit Decision</button>
            </div>
        </div>
    </div>

    <script src="../js/utils.js"></script>
    <script src="../js/dashboard-evaluator.js"></script>
</body>
</html>
